<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body id="page-top">
<div id="wrapper">
<%- include('partials/sidebar') %>
<div id="content-wrapper" class="d-flex flex-column">
<div id="content">
<%- include('partials/topbar') %>
<div class="container-fluid">
<h1 class="h3 mb-4 text-gray-800">Dashboard</h1>
<form method="get" class="row g-3 mb-4">
<div class="col-md-3">
<label>Start Date</label>
<input type="date" class="form-control" name="startdate" value="<%= startdate || '' %>">
</div>
<div class="col-md-3">
<label>End Date</label>
<input type="date" class="form-control" name="enddate" value="<%= enddate || '' %>">
</div>
<div class="col-md-3 align-self-end">
<button class="btn btn-primary">Filter</button>
<button type="button" onclick="window.print()" class="btn btn-secondary">Generate Report</button>
</div>
</form>
<div class="row text-center mb-4">
<div class="col-md-3">
<div class="card border-left-primary shadow py-2">
<div class="card-body">
<h5>Revenue</h5>
<h4>Rp <%= revenue.toLocaleString('id-ID') %></h4>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-left-success shadow py-2">
<div class="card-body">
<h5>Expense</h5>
<h4>Rp <%= expense.toLocaleString('id-ID') %></h4>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-left-warning shadow py-2">
<div class="card-body">
<h5>Earnings</h5>
<h4>Rp <%= earnings.toLocaleString('id-ID') %></h4>
</div>
</div>
</div>
<div class="col-md-3">
<div class="card border-left-info shadow py-2">
<div class="card-body">
<h5>Total Sales</h5>
<h4><%= totalSales %></h4>
</div>
</div>
</div>
</div>




<!-- Charts Row -->
<div class="row mb-4">
<!-- Earnings Overview Line Chart -->
<div class="col-xl-8 col-lg-7">
<div class="card shadow mb-4">
<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
<h6 class="m-0 font-weight-bold text-primary">Earnings Overview</h6>
</div>
<div class="card-body">
<div class="chart-area">
<canvas id="earningsChart"></canvas>
</div>
</div>
</div>
</div>

<!-- Revenue Source Pie Chart -->
<div class="col-xl-4 col-lg-5">
<div class="card shadow mb-4">
<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
<h6 class="m-0 font-weight-bold text-primary">Revenue Sources</h6>
</div>
<div class="card-body">
<div class="chart-pie pt-4 pb-2">
<canvas id="revenueChart"></canvas>
</div>
<div class="mt-4 text-center small">
<span class="mr-2">
<i class="fas fa-circle text-primary"></i> Direct
</span>
<span class="mr-2">
<i class="fas fa-circle text-success"></i> Customer
</span>
</div>
</div>
</div>
</div>
</div>


<!-- Monthly Revenue Table -->
<div class="card shadow mb-4">
<div class="card-header py-3">
<h6 class="m-0 font-weight-bold text-primary">Monthly Revenue Summary</h6>
</div>
<div class="card-body">
<div class="table-responsive">
<table id="dashboardTable" class="table table-bordered" width="100%" cellspacing="0">
<thead>
<tr>
<th>Month</th>
<th>Revenue</th>
<th>Expense</th>
<th>Earnings</th>
</tr>
</thead>
<tfoot>
<tr>
<th>Total</th>
<th>Revenue</th>
<th>Expense</th>
<th>Earnings</th>
</tr>
</tfoot>
<tbody>
<% if (monthly.length === 0) { %>
<tr>
<td colspan="4" class="text-center">No data available</td>
</tr>
<% } else { %>
<% monthly.forEach(row => { %>
<tr>
<td><%= row.month %></td>
<td>Rp <%= Number(row.revenue).toLocaleString('id-ID') %></td>
<td>Rp <%= Number(row.expense).toLocaleString('id-ID') %></td>
<td>Rp <%= Number(row.earnings).toLocaleString('id-ID') %></td>
</tr>
<% }) %>
<% } %>
</tbody>
</table>
</div>
</div>
</div>

</div>
</div>
</div>
<%- include('partials/footer') %>
</div>
</body>
</html>