<!DOCTYPE html>
<html lang="en">
<%- include('partials/head') %>
<body id="page-top">
  <div id="wrapper">
    <%- include('partials/sidebar') %>
    <div id="content-wrapper" class="d-flex flex-column">
      <div id="content">
        <%- include('partials/topbar') %>
        <div class="container-fluid">
          <h1 class="h3 mb-4 text-gray-800">Dashboard</h1>

          <form method="get" class="row g-3 mb-4">
            <div class="col-md-3">
              <label>Start Date</label>
              <input type="date" class="form-control" name="startdate" value="<%= startdate || '' %>">
            </div>
            <div class="col-md-3">
              <label>End Date</label>
              <input type="date" class="form-control" name="enddate" value="<%= enddate || '' %>">
            </div>
            <div class="col-md-3 align-self-end">
              <button class="btn btn-primary">Filter</button>
              <button type="button" onclick="window.print()" class="btn btn-secondary">Generate Report</button>
            </div>
          </form>

          <div class="row text-center mb-4">
            <div class="col-md-3">
              <div class="card border-left-primary shadow py-2">
                <div class="card-body">
                  <h5>Revenue</h5>
                  <h4>Rp <%= revenue.toLocaleString('id-ID') %></h4>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card border-left-success shadow py-2">
                <div class="card-body">
                  <h5>Expense</h5>
                  <h4>Rp <%= expense.toLocaleString('id-ID') %></h4>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card border-left-warning shadow py-2">
                <div class="card-body">
                  <h5>Earnings</h5>
                  <h4>Rp <%= earnings.toLocaleString('id-ID') %></h4>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card border-left-info shadow py-2">
                <div class="card-body">
                  <h5>Total Sales</h5>
                  <h4><%= totalSales %></h4>
                </div>
              </div>
            </div>
          </div>

          <div class="card shadow">
            <div class="card-body">
              <table id="dashboardTable" class="table table-bordered">
                <thead>
                  <tr>
                    <th>Month</th>
                    <th>Revenue</th>
                    <th>Expense</th>
                    <th>Earnings</th>
                  </tr>
                </thead>
                <tbody>
                  <% monthly.forEach(row => { %>
                    <tr>
                      <td><%= row.month %></td>
                      <td>Rp <%= Number(row.revenue).toLocaleString('id-ID') %></td>
                      <td>Rp <%= Number(row.expense).toLocaleString('id-ID') %></td>
                      <td>Rp <%= Number(row.earnings).toLocaleString('id-ID') %></td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</body>
</html>
