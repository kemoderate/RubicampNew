<!-- Scroll to Top Button-->
<a class="scroll-to-top rounded" href="#page-top">
  <i class="fas fa-angle-up"></i>
</a>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete this user?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button id="confirmDelete" type="button" class="btn btn-primary">Delete</button>
      </div>
    </div>
  </div>
</div>

<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Ready to Leave?</h5>
        <button class="close" type="button" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
      <div class="modal-body">Select Logout to end your current session.</div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
        <a class="btn btn-primary" href="/logout">Logout</a>
      </div>
    </div>
  </div>
</div>

<!-- JS Scripts -->

<script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/vendor/jquery-easing/jquery.easing.min.js"></script>
<script src="/js/sb-admin-2.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="/vendor/chart.js/Chart.min.js"></script>
<script src="/js/demo/chart-area-demo.js"></script>
<script src="/js/demo/chart-pie-demo.js"></script>


<!-- data tables -->
<script>
  $(document).ready(function () {
    $('#myTable').DataTable({
      // Opsi tambahan bisa ditambahkan di sini
      // misal: paging, searching, order, dll
      paging: true,
      searching: true,
      ordering: true, // ini untuk enable sort
      columnDefs: [{ orderable: false, targets: 4 }], // actions column tidak sortable
      pageLength: 3,

      // ðŸ”¹ Dropdown pilihan entries
      lengthMenu: [[3, 5, 10, 25, 50, -1], [3, 5, 10, 25, 50, "All"]]
    });
  });
</script>
<!-- CRUD mulai dari sini -->
<script>
let currentEntity = null;

  // edit
  $(document).on('click', '.btn-edit', function () {
    const userId = $(this).data('id')
    currentEntity = $(this).data('entity')

    if(!id || !currentEntity ) return alert ('Data edit tidak lengkap');
    window.location.href = `/${currentEntity}/edit/${encodeURIComponent(id)}`;
  })
  // submit edit
  $(document).ready(function () {
    $('#btnSave').click(function (e) {
      e.preventDefault()
      $('form').submit()
    })
  })

  // delete 
  $(function () {
    
    let deleteUserId = null;

    // Pakai event delegation biar jalan walau DataTables re-render
    $('#myTable').on('click', '.btn-delete', function (e) {
      e.preventDefault();

      deleteUserId = $(this).data('id');
      console.log('btn-delete clicked, id =', deleteUserId);

      if (!deleteUserId) {
        alert('ID user tidak ditemukan!');
        return;
      }

      // Show modal pakai Bootstrap 4 (jQuery)
      $('#deleteModal').modal('show');
    });

    // Tombol confirm delete
    $('#confirmDelete').off('click').on('click', function (e) {
      e.preventDefault();
      console.log('confirmDelete clicked, deleteUserId =', deleteUserId);

      if (!deleteUserId) {
        alert('Tidak ada user yang dipilih untuk dihapus');
        return;
      }

      // Redirect ke route delete
      window.location.href = `/users/delete/${encodeURIComponent(deleteUserId)}`;
    });

    // Reset id saat modal ditutup
    $('#deleteModal').on('hidden.bs.modal', function () {
      console.log('deleteModal hidden - reset deleteUserId');
      deleteUserId = null;
    });
  });



</script>